/*! mpulse v1.0.0 */

!function(a){"use strict";function b(b,c){l||("object"==typeof XDomainRequest?(t=!0,l=function(){return new XDomainRequest}):"function"==typeof XMLHttpRequest||"object"==typeof XMLHttpRequest?l=function(){return new XMLHttpRequest}:"function"==typeof require?l=function(){var a=require("xmlhttprequest").XMLHttpRequest;return new a}:a&&"undefined"!=typeof a.ActiveXObject&&(l=function(){return new a.ActiveXObject("Microsoft.XMLHTTP")}));var d=l();"function"==typeof c&&(t?d.onload=function(){c(d.responseText)}:d.onreadystatechange=function(){4===d.readyState&&c(d.responseText)}),d.open("GET",b,!0),d.send()}function c(a){"object"==typeof console&&"function"==typeof console.warn&&console.warn("mPulse: "+a)}function d(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0,c="x"===a?b:3&b|8;return c.toString(16)})}function e(a,b,c){if("undefined"==typeof CryptoJS||"function"!=typeof CryptoJS.HmacSHA256)return"";var d="key="+a+"&t="+c;return CryptoJS.HmacSHA256(d,b).toString()}function f(f,g,h){function i(b){return-1!==b.indexOf("http://")||-1!==b.indexOf("https://")?b:(W?b="https:"+b:"undefined"==typeof a?-1===b.indexOf("http:")&&(b="http:"+b):"undefined"!=typeof a&&"file:"===a.location.protocol&&-1===b.indexOf("http:")&&(b="http:"+b),b)}function j(){var a=V,b=+new Date;return a+=-1!==a.indexOf("?")?"&":"?",a+="key="+T,a+="&t="+b,a+="&s="+e(T,U,b),i(a)}function k(){var a=X.beacon_url;return i(a)}function l(a){try{var b=JSON.parse(a);for(var c in b)b.hasOwnProperty(c)&&(X[c]=b[c])}catch(d){return void(Z=!1)}if(ea||N(X.session_id),fa={},ha={},da={},X.PageParams){var e=X.PageParams.customMetrics,f=X.PageParams.customTimers,g=X.PageParams.customDimensions;if(e)for(s=0;s<e.length;s++){var h=e[s];fa[h.name]=h.label}if(f)for(s=0;s<f.length;s++){var i=f[s];ha[i.name]=i.label}if(g)for(s=0;s<g.length;s++){var j=g[s];da[j.name]=j.label}}Z=!0,Y=!0,setTimeout(q,n),m(x)}function q(){if(""!==V){var a=j();Y&&(a+="&r="),b(a,l)}}function t(){var a={};for(var b in ca)ca.hasOwnProperty(b)&&(a[b]=ca[b]);return a}function w(a,b,c){$.push({type:a,name:b,value:c,group:aa,ab:ba,dimensions:t(),when:+new Date})}function x(a){if(0!==$.length){if(!Z)return void((!_||a)&&(_=!0,setTimeout(function(){x(!0)},o)));var b=$.shift(),d=b.type,e=b.name,f=b.value,g={};"boolean"!=typeof b.group&&(g["h.pg"]=b.group),"boolean"!=typeof b.ab&&(g["h.ab"]=b.ab),g.when=b.when;for(var h in b.dimensions)b.dimensions.hasOwnProperty(h)&&("undefined"!=typeof da[h]?g[da[h]]=b.dimensions[h]:c("Custom Dimension '"+h+"' is not defined"));"metric"===d?"undefined"!=typeof fa[e]?(g[fa[e]]=f,y(g)):c("Custom Metric '"+e+"' is not defined"):"timer"===d&&("undefined"!=typeof ha[e]?(g.t_other=ha[e]+"|"+f,y(g)):c("Custom Timer '"+e+"' is not defined")),m(x)}}function y(a){a.d=X.site_domain,a["h.key"]=X["h.key"],a["h.d"]=X["h.d"],a["h.cr"]=X["h.cr"],a["h.t"]=X["h.t"],a["http.initiator"]="api",a["rt.start"]="api",ea!==!1&&(a["rt.si"]=ea,a["rt.ss"]=Math.round(ja+v),a["rt.sl"]=ka),a.api=1,a["api.v"]=2,a["api.l"]="js",a["api.lv"]=p,S("before_beacon",a);var c=[];for(var d in a)a.hasOwnProperty(d)&&c.push(encodeURIComponent(d)+"="+(void 0===a[d]||null===a[d]?"":encodeURIComponent(a[d])));var e=k(),f=e+(e.indexOf("?")>-1?"&":"?")+c.join("&");S("beacon",a),b(f)}function z(a){return"string"!=typeof a?-1:(ia++,ga[ia]={time:u(),name:a},ia)}function A(a){if("number"!=typeof a||0>a)return-1;var b=ga[a],c=0;return b?(c=Math.round(u()-b.time),B(b.name,c),delete ga[a],c):-1}function B(a,b){return"string"!=typeof a?-1:"number"!=typeof b||0>b?-1:(b=Math.round(b),w("timer",a,b),m(x),b)}function C(a,b){"string"==typeof a&&("undefined"==typeof b||"number"==typeof b)&&("undefined"==typeof b&&(b=1),w("metric",a,b),m(x))}function D(a){"string"==typeof a&&(aa=a)}function E(){return aa}function F(){aa=!1}function G(a){return"string"!=typeof a?!1:/^[a-zA-Z0-9_ -]{1,25}$/.test(a)===!1?!1:(ba=a,!0)}function H(){return ba}function I(){ba=!1}function J(a,b){return"undefined"!=typeof a?"undefined"==typeof b?void K(a):void(ca[a]=b):void 0}function K(a){"undefined"!=typeof a&&"undefined"!=typeof ca[a]&&delete ca[a]}function L(a){("string"==typeof a||"number"==typeof a)&&("number"==typeof a&&(a=""+a),ea=a)}function M(){return ea}function N(a){return L(a||d()),P(0),M()}function O(){ka++}function P(a){"number"!=typeof a||0>a||(ka=a)}function Q(){return ka}function R(a,b){la.hasOwnProperty(a)&&"function"==typeof b&&la[a].push(b)}function S(a,b){for(var c=0;c<la[a].length;c++)la[a][c](b)}h=h||{};var T=f,U=g,V="//c.go-mpulse.net/api/v2/config.json",W=!1,X={},Y=!1,Z=!1,$=[],_=!1,aa=!1,ba=!1,ca={},da={},ea=!1,fa={},ga={},ha={},ia=-1,ja=u(),ka=0,la={};for(s=0;s<r.length;s++)la[r[s]]=[];"undefined"!=typeof h.configUrl&&(V=h.configUrl),h.forceSSL&&(W=!0),q();var ma={startTimer:z,stopTimer:A,sendTimer:B,sendMetric:C,setPageGroup:D,getPageGroup:E,resetPageGroup:F,setABTest:G,getABTest:H,resetABTest:I,setDimension:J,resetDimension:K,setSessionID:L,getSessionID:M,startSession:N,incrementSessionLength:O,setSessionLength:P,getSessionLength:Q,subscribe:R,parseConfig:l};return ma}function g(){return y.mPulse=z,x}function h(a,b,c){if(c=c||{},"undefined"!=typeof c.name&&"undefined"!=typeof B[c.name])return B[c.name];var d=f(a,b,c);if(A===!1){A=d;for(var e=0;e<q.length;e++){var g=q[e];x[g]=A[g]}}return"undefined"!=typeof c.name&&(B[c.name]=d),d}function i(a){return B[a]}function j(){}function k(a){"undefined"!=typeof B[a]&&delete B[a]}var l,m,n=3e5,o=5e3,p="0.0.1",q=["startTimer","stopTimer","sendTimer","sendMetric","setPageGroup","getPageGroup","resetPageGroup","setABTest","getABTest","resetABTest","setDimension","resetDimension","setSessionID","getSessionID","startSession","incrementSessionLength","setSessionLength","getSessionLength","subscribe"],r=["before_beacon","beacon"],s=0,t=!1,u=!1,v=+new Date;if(m="undefined"!=typeof process&&"function"==typeof process.nextTick?process.nextTick.bind(process):"undefined"!=typeof a?a.setImmediate?a.setImmediate.bind(a):a.msSetImmediate?a.msSetImmediate.bind(a):a.webkitSetImmediate?a.webkitSetImmediate.bind(a):a.mozSetImmediate?a.mozSetImmediate.bind(a):function(a){setTimeout(a,10)}:function(a){setTimeout(a,10)},"undefined"!=typeof a)if("undefined"!=typeof a.performance&&"function"==typeof a.performance.now)u=a.performance.now.bind(a.performance);else if("undefined"!=typeof a.performance){var w=["webkitNow","msNow","mozNow"];for(s=0;s<w.length;s++)if("function"==typeof a.performance[w[s]]){u=a.performance[w[s]];break}}u||("undefined"!=typeof a&&a.performance&&a.performance.timing&&a.performance.timing.navigationStart&&(v=a.performance.timing.navigationStart),u="undefined"!=typeof Date&&Date.now?function(){return Date.now()-v}:function(){return+new Date-v});var x,y,z,A=!1,B={};for("undefined"!=typeof a&&(y=a,z=y.mPulse),x={version:p,noConflict:g,init:h,getApp:i,stop:k},s=0;s<q.length;s++)x[q[s]]=j;"function"==typeof define&&define.amd?define([],function(){return x}):"undefined"!=typeof module&&module.exports?module.exports=x:"undefined"!=typeof y&&(y.mPulse=x)}("undefined"!=typeof window?window:void 0);
//# sourceMappingURL=mpulse.min.js.map